{"ast":null,"code":"var _jsxFileName = \"/home/alastair/Desktop/outpost-custom/outpost-custom/src/pages/ProductBrowser.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { Filter, Grid, List, Sparkles, Loader2 } from 'lucide-react';\nimport { getAllProducts, getFilterOptions } from '../lib/productBrowserApi';\nimport FilterSidebar from '../components/FilterSidebar';\nimport SmartSearchModal from '../components/SmartSearchModal';\nimport ProductCard from '../components/ProductCard';\nimport ProductSkeleton from '../components/ProductSkeleton';\nimport './ProductBrowser.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ProductBrowser = () => {\n  _s();\n  const [allProducts, setAllProducts] = useState([]);\n  const [productGroups, setProductGroups] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [loadingMore, setLoadingMore] = useState(false);\n  const [hasMoreProducts, setHasMoreProducts] = useState(true);\n  const [currentFilters, setCurrentFilters] = useState({});\n  const [filterOptions, setFilterOptions] = useState({\n    materials: [],\n    categories: [],\n    priceRange: {\n      min: 0,\n      max: 1000\n    },\n    productTypes: [],\n    sizes: [],\n    colors: [],\n    colorShades: [],\n    brands: [],\n    genders: [],\n    ageGroups: [],\n    accreditations: []\n  });\n  const [currentPage, setCurrentPage] = useState(1);\n  const [totalCount, setTotalCount] = useState(0);\n  const [isSmartSearchOpen, setIsSmartSearchOpen] = useState(false);\n  const [viewMode, setViewMode] = useState('grid');\n\n  // Intersection Observer ref for infinite scroll\n  const loadMoreRef = useRef(null);\n  const pageSize = 100; // Increased to ensure viewport is filled initially\n\n  // Load filter options on mount\n  useEffect(() => {\n    const loadFilterOptions = async () => {\n      try {\n        const options = await getFilterOptions();\n        setFilterOptions(options);\n      } catch (error) {\n        console.error('Error loading filter options:', error);\n      }\n    };\n    loadFilterOptions();\n  }, []);\n\n  // Group products by style (memoized to prevent unnecessary re-renders)\n  const groupProductsByStyle = useCallback(products => {\n    const grouped = products.reduce((groups, product) => {\n      const styleCode = product.style_code || 'unknown';\n      if (!groups[styleCode]) {\n        groups[styleCode] = [];\n      }\n      groups[styleCode].push(product);\n      return groups;\n    }, {});\n\n    // Sort the style codes to ensure consistent ordering\n    const sortedStyleCodes = Object.keys(grouped).sort();\n    return sortedStyleCodes.map(styleCode => {\n      const variants = grouped[styleCode];\n      const firstVariant = variants[0];\n\n      // Get unique colors with improved color mapping\n      const uniqueColors = variants.reduce((colors, variant) => {\n        const existingColor = colors.find(c => c.code === variant.colour_code);\n        if (!existingColor && variant.colour_code) {\n          // Use improved color mapping logic\n          const colorName = (variant.colour_name || '').toLowerCase();\n          let rgbValue = '#cccccc'; // Default fallback\n\n          // First try to use color name mapping for better accuracy\n          if (colorName.includes('black')) rgbValue = '#000000';else if (colorName.includes('white')) rgbValue = '#ffffff';else if (colorName.includes('red')) rgbValue = '#dc3545';else if (colorName.includes('blue')) rgbValue = '#007bff';else if (colorName.includes('green')) rgbValue = '#28a745';else if (colorName.includes('yellow')) rgbValue = '#ffc107';else if (colorName.includes('grey') || colorName.includes('gray')) rgbValue = '#6c757d';else if (colorName.includes('navy')) rgbValue = '#001f3f';else if (colorName.includes('orange')) rgbValue = '#ff6b35';else if (colorName.includes('purple')) rgbValue = '#6f42c1';else if (colorName.includes('pink')) rgbValue = '#e83e8c';else if (colorName.includes('brown')) rgbValue = '#8b4513';else if (variant.rgb && variant.rgb !== 'Not available') {\n            // Fall back to database RGB if available and not obviously wrong\n            try {\n              const rgbParts = variant.rgb.split('|')[0].trim();\n              const rgbNumbers = rgbParts.match(/\\d+/g);\n              if (rgbNumbers && rgbNumbers.length >= 3) {\n                const r = parseInt(rgbNumbers[0]);\n                const g = parseInt(rgbNumbers[1]);\n                const b = parseInt(rgbNumbers[2]);\n                if (r >= 0 && r <= 255 && g >= 0 && g <= 255 && b >= 0 && b <= 255) {\n                  rgbValue = `rgb(${r}, ${g}, ${b})`;\n                }\n              }\n            } catch (e) {\n              console.warn('Failed to parse RGB for', variant.colour_name, ':', variant.rgb);\n            }\n          }\n          colors.push({\n            code: variant.colour_code,\n            name: variant.colour_name || variant.colour_code,\n            rgb: rgbValue,\n            image: variant.colour_image || variant.primary_product_image_url\n          });\n        }\n        return colors;\n      }, []);\n\n      // Calculate price range\n      const prices = variants.map(v => parseFloat(v.single_price)).filter(p => !isNaN(p) && p > 0);\n      const priceRange = prices.length > 0 ? {\n        min: Math.min(...prices),\n        max: Math.max(...prices)\n      } : {\n        min: 0,\n        max: 0\n      };\n      return {\n        style_code: styleCode,\n        style_name: firstVariant.style_name,\n        brand: firstVariant.brand,\n        variants,\n        colors: uniqueColors,\n        size_range: firstVariant.size_range || '',\n        price_range: priceRange\n      };\n    });\n  }, []);\n\n  // Load initial products or reset with new filters\n  const loadProducts = useCallback(async (filters, reset = true) => {\n    try {\n      console.log('ðŸ”„ Loading products with filters:', JSON.stringify(filters, null, 2));\n      if (reset) {\n        setLoading(true);\n        setCurrentPage(1);\n        setAllProducts([]);\n        setProductGroups([]);\n      } else {\n        setLoadingMore(true);\n      }\n      const pageToLoad = reset ? 1 : currentPage;\n      const response = await getAllProducts(filters, pageToLoad, pageSize);\n      console.log('ðŸ“¦ Product API Response:', {\n        totalCount: response.totalCount,\n        productsLength: response.products.length,\n        currentPage: response.currentPage,\n        totalPages: response.totalPages,\n        firstProduct: response.products[0] || 'No products'\n      });\n      setTotalCount(response.totalCount);\n      setHasMoreProducts(response.hasNextPage);\n\n      // Update products list\n      if (reset) {\n        setAllProducts(response.products);\n      } else {\n        setAllProducts(prev => [...prev, ...response.products]);\n        setCurrentPage(prev => prev + 1);\n      }\n    } catch (error) {\n      console.error('âŒ Error loading products:', error);\n      if (reset) {\n        setAllProducts([]);\n        setProductGroups([]);\n        setTotalCount(0);\n        setHasMoreProducts(false);\n      }\n    } finally {\n      setLoading(false);\n      setLoadingMore(false);\n    }\n  }, [currentPage, pageSize]);\n\n  // Load more products for infinite scroll\n  const loadMoreProducts = useCallback(async () => {\n    if (!hasMoreProducts || loadingMore || loading) return;\n    await loadProducts(currentFilters, false);\n  }, [hasMoreProducts, loadingMore, loading, currentFilters, loadProducts]);\n\n  // Initial load\n  useEffect(() => {\n    loadProducts({});\n  }, []);\n\n  // Update product groups when allProducts changes\n  useEffect(() => {\n    if (allProducts.length > 0) {\n      const grouped = groupProductsByStyle(allProducts);\n      console.log('ðŸ“Š Product groups created:', grouped.length, 'groups from', allProducts.length, 'products');\n      setProductGroups(grouped);\n\n      // Auto-load more if we don't have enough products to fill viewport\n      setTimeout(() => {\n        if (grouped.length < 12 && hasMoreProducts && !loadingMore && !loading) {\n          console.log('ðŸ”„ Auto-loading more products to fill viewport...');\n          loadMoreProducts();\n        }\n      }, 100);\n    }\n  }, [allProducts, groupProductsByStyle, hasMoreProducts, loadingMore, loading, loadMoreProducts]);\n\n  // Set up intersection observer for infinite scroll\n  useEffect(() => {\n    const observer = new IntersectionObserver(entries => {\n      const target = entries[0];\n      if (target.isIntersecting && hasMoreProducts && !loadingMore && !loading) {\n        console.log('ðŸ”„ Loading more products...');\n        loadMoreProducts();\n      }\n    }, {\n      root: null,\n      rootMargin: '200px',\n      // Start loading 200px before reaching the bottom\n      threshold: 0.1\n    });\n    const currentRef = loadMoreRef.current;\n    if (currentRef) {\n      observer.observe(currentRef);\n    }\n    return () => {\n      if (currentRef) {\n        observer.unobserve(currentRef);\n      }\n    };\n  }, [hasMoreProducts, loadingMore, loading, loadMoreProducts]);\n  const handleFiltersChange = filters => {\n    setCurrentFilters(filters);\n    loadProducts(filters, true); // Reset to page 1 with new filters\n  };\n  const handleSmartSearch = async (query, filters) => {\n    const searchFilters = {\n      ...filters,\n      searchQuery: query\n    };\n    console.log('Smart Search Filters Applied:', JSON.stringify(searchFilters, null, 2));\n    setCurrentFilters(searchFilters);\n    await loadProducts(searchFilters, true);\n\n    // If no results with AI filters, try with just the search query\n    setTimeout(() => {\n      if (totalCount === 0) {\n        console.log('No results with AI filters, trying text search only...');\n        setCurrentFilters({\n          searchQuery: query\n        });\n        loadProducts({\n          searchQuery: query\n        }, true);\n      }\n    }, 1000);\n  };\n  const getActiveFilterCount = () => {\n    let count = 0;\n    Object.entries(currentFilters).forEach(([key, value]) => {\n      if (key === 'searchQuery' && value) count++;else if (key.includes('price') && value !== undefined) count++;else if (Array.isArray(value) && value.length > 0) count += value.length;\n    });\n    return count;\n  };\n  const clearAllFilters = () => {\n    setCurrentFilters({});\n    loadProducts({}, true); // true = reset to first page\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"product-browser\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"browser-layout\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"browser-header\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"container\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"header-content\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"title-section\",\n              children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n                children: \"Discover Products\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 314,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"subtitle\",\n                children: loading ? 'Loading...' : `${productGroups.length.toLocaleString()} products${hasMoreProducts ? ' (loading more...)' : ' available'}`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 315,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 313,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"header-controls\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"smart-search-btn\",\n                onClick: () => setIsSmartSearchOpen(true),\n                children: [/*#__PURE__*/_jsxDEV(Sparkles, {\n                  size: 20\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 325,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"Smart Search\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 326,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 321,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"view-toggle\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  className: `view-btn ${viewMode === 'grid' ? 'active' : ''}`,\n                  onClick: () => setViewMode('grid'),\n                  children: /*#__PURE__*/_jsxDEV(Grid, {\n                    size: 18\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 334,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 330,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: `view-btn ${viewMode === 'list' ? 'active' : ''}`,\n                  onClick: () => setViewMode('list'),\n                  children: /*#__PURE__*/_jsxDEV(List, {\n                    size: 18\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 340,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 336,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 329,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 320,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 13\n          }, this), currentFilters.searchQuery && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"active-search-bar\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"search-info\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"search-label\",\n                children: \"Search results for:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 350,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"search-query\",\n                children: [\"\\\"\", currentFilters.searchQuery, \"\\\"\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 351,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"clear-search-btn\",\n                onClick: () => handleFiltersChange({\n                  ...currentFilters,\n                  searchQuery: undefined\n                }),\n                children: \"Clear search\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 352,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 349,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 348,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 311,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 310,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"browser-content\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"container\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"content-layout\",\n            children: [/*#__PURE__*/_jsxDEV(FilterSidebar, {\n              filterOptions: filterOptions,\n              currentFilters: currentFilters,\n              onFiltersChange: handleFiltersChange,\n              totalResults: totalCount\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 370,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"products-area\",\n              children: [loading && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"products-loading\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: `products-skeleton ${viewMode}`,\n                  children: Array.from({\n                    length: 12\n                  }).map((_, i) => /*#__PURE__*/_jsxDEV(ProductSkeleton, {}, i, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 384,\n                    columnNumber: 25\n                  }, this))\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 382,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 381,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: `products-container ${viewMode}`,\n                children: productGroups.map(group => /*#__PURE__*/_jsxDEV(ProductCard, {\n                  productGroup: group,\n                  viewMode: viewMode\n                }, group.style_code, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 393,\n                  columnNumber: 21\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 391,\n                columnNumber: 17\n              }, this), loadingMore && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"loading-more\",\n                children: [/*#__PURE__*/_jsxDEV(Loader2, {\n                  className: \"loading-spinner\",\n                  size: 32\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 404,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"Loading more products...\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 405,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 403,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                ref: loadMoreRef,\n                className: \"load-more-trigger\",\n                style: {\n                  height: hasMoreProducts ? '20px' : '0px'\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 410,\n                columnNumber: 17\n              }, this), productGroups.length === 0 && !loading && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"empty-state\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"empty-content\",\n                  children: [/*#__PURE__*/_jsxDEV(Filter, {\n                    size: 48,\n                    className: \"empty-icon\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 418,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n                    children: \"No products found\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 419,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    children: \"Try adjusting your filters or search terms\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 420,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"reset-filters-btn\",\n                    onClick: clearAllFilters,\n                    children: \"Clear all filters\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 421,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 417,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 416,\n                columnNumber: 19\n              }, this), !hasMoreProducts && productGroups.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"end-of-results\",\n                children: /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: [\"You've seen all \", productGroups.length, \" products!\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 431,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 430,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 378,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 367,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 366,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 365,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(SmartSearchModal, {\n        isOpen: isSmartSearchOpen,\n        onClose: () => setIsSmartSearchOpen(false),\n        onApplySearch: handleSmartSearch\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 440,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 308,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 307,\n    columnNumber: 5\n  }, this);\n};\n_s(ProductBrowser, \"ifv+OnhVnBcFAYs8L0qtGjlLy70=\");\n_c = ProductBrowser;\nexport default ProductBrowser;\nvar _c;\n$RefreshReg$(_c, \"ProductBrowser\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useRef","Filter","Grid","List","Sparkles","Loader2","getAllProducts","getFilterOptions","FilterSidebar","SmartSearchModal","ProductCard","ProductSkeleton","jsxDEV","_jsxDEV","ProductBrowser","_s","allProducts","setAllProducts","productGroups","setProductGroups","loading","setLoading","loadingMore","setLoadingMore","hasMoreProducts","setHasMoreProducts","currentFilters","setCurrentFilters","filterOptions","setFilterOptions","materials","categories","priceRange","min","max","productTypes","sizes","colors","colorShades","brands","genders","ageGroups","accreditations","currentPage","setCurrentPage","totalCount","setTotalCount","isSmartSearchOpen","setIsSmartSearchOpen","viewMode","setViewMode","loadMoreRef","pageSize","loadFilterOptions","options","error","console","groupProductsByStyle","products","grouped","reduce","groups","product","styleCode","style_code","push","sortedStyleCodes","Object","keys","sort","map","variants","firstVariant","uniqueColors","variant","existingColor","find","c","code","colour_code","colorName","colour_name","toLowerCase","rgbValue","includes","rgb","rgbParts","split","trim","rgbNumbers","match","length","r","parseInt","g","b","e","warn","name","image","colour_image","primary_product_image_url","prices","v","parseFloat","single_price","filter","p","isNaN","Math","style_name","brand","size_range","price_range","loadProducts","filters","reset","log","JSON","stringify","pageToLoad","response","productsLength","totalPages","firstProduct","hasNextPage","prev","loadMoreProducts","setTimeout","observer","IntersectionObserver","entries","target","isIntersecting","root","rootMargin","threshold","currentRef","current","observe","unobserve","handleFiltersChange","handleSmartSearch","query","searchFilters","searchQuery","getActiveFilterCount","count","forEach","key","value","undefined","Array","isArray","clearAllFilters","className","children","fileName","_jsxFileName","lineNumber","columnNumber","toLocaleString","onClick","size","onFiltersChange","totalResults","from","_","i","group","productGroup","ref","style","height","isOpen","onClose","onApplySearch","_c","$RefreshReg$"],"sources":["/home/alastair/Desktop/outpost-custom/outpost-custom/src/pages/ProductBrowser.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { Filter, Grid, List, Sparkles, Loader2 } from 'lucide-react';\nimport { getAllProducts, getFilterOptions, ProductFilters, ProductsResponse, FilterOptions } from '../lib/productBrowserApi';\nimport { Product } from '../lib/supabase';\nimport FilterSidebar from '../components/FilterSidebar';\nimport SmartSearchModal from '../components/SmartSearchModal';\nimport ProductCard from '../components/ProductCard';\nimport ProductSkeleton from '../components/ProductSkeleton';\nimport './ProductBrowser.css';\n\ninterface ProductGroup {\n  style_code: string;\n  style_name: string;\n  brand: string;\n  variants: Product[];\n  colors: Array<{\n    code: string;\n    name: string;\n    rgb: string;\n    image: string;\n  }>;\n  size_range: string;\n  price_range: { min: number; max: number };\n}\n\nconst ProductBrowser: React.FC = () => {\n  const [allProducts, setAllProducts] = useState<Product[]>([]);\n  const [productGroups, setProductGroups] = useState<ProductGroup[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [loadingMore, setLoadingMore] = useState(false);\n  const [hasMoreProducts, setHasMoreProducts] = useState(true);\n  const [currentFilters, setCurrentFilters] = useState<ProductFilters>({});\n  const [filterOptions, setFilterOptions] = useState<FilterOptions>({\n    materials: [],\n    categories: [],\n    priceRange: { min: 0, max: 1000 },\n    productTypes: [],\n    sizes: [],\n    colors: [],\n    colorShades: [],\n    brands: [],\n    genders: [],\n    ageGroups: [],\n    accreditations: []\n  });\n  \n  const [currentPage, setCurrentPage] = useState(1);\n  const [totalCount, setTotalCount] = useState(0);\n  \n  const [isSmartSearchOpen, setIsSmartSearchOpen] = useState(false);\n  const [viewMode, setViewMode] = useState<'grid' | 'list'>('grid');\n  \n  // Intersection Observer ref for infinite scroll\n  const loadMoreRef = useRef<HTMLDivElement>(null);\n  \n  const pageSize = 100; // Increased to ensure viewport is filled initially\n\n  // Load filter options on mount\n  useEffect(() => {\n    const loadFilterOptions = async () => {\n      try {\n        const options = await getFilterOptions();\n        setFilterOptions(options);\n      } catch (error) {\n        console.error('Error loading filter options:', error);\n      }\n    };\n    loadFilterOptions();\n  }, []);\n\n  // Group products by style (memoized to prevent unnecessary re-renders)\n  const groupProductsByStyle = useCallback((products: Product[]): ProductGroup[] => {\n    const grouped = products.reduce((groups: Record<string, Product[]>, product) => {\n      const styleCode = product.style_code || 'unknown';\n      if (!groups[styleCode]) {\n        groups[styleCode] = [];\n      }\n      groups[styleCode].push(product);\n      return groups;\n    }, {});\n\n    // Sort the style codes to ensure consistent ordering\n    const sortedStyleCodes = Object.keys(grouped).sort();\n    \n    return sortedStyleCodes.map(styleCode => {\n      const variants = grouped[styleCode];\n      const firstVariant = variants[0];\n      \n      // Get unique colors with improved color mapping\n      const uniqueColors = variants.reduce((colors: Array<{code: string, name: string, rgb: string, image: string}>, variant) => {\n        const existingColor = colors.find(c => c.code === variant.colour_code);\n        if (!existingColor && variant.colour_code) {\n          // Use improved color mapping logic\n          const colorName = (variant.colour_name || '').toLowerCase();\n          let rgbValue = '#cccccc'; // Default fallback\n          \n          // First try to use color name mapping for better accuracy\n          if (colorName.includes('black')) rgbValue = '#000000';\n          else if (colorName.includes('white')) rgbValue = '#ffffff';\n          else if (colorName.includes('red')) rgbValue = '#dc3545';\n          else if (colorName.includes('blue')) rgbValue = '#007bff';\n          else if (colorName.includes('green')) rgbValue = '#28a745';\n          else if (colorName.includes('yellow')) rgbValue = '#ffc107';\n          else if (colorName.includes('grey') || colorName.includes('gray')) rgbValue = '#6c757d';\n          else if (colorName.includes('navy')) rgbValue = '#001f3f';\n          else if (colorName.includes('orange')) rgbValue = '#ff6b35';\n          else if (colorName.includes('purple')) rgbValue = '#6f42c1';\n          else if (colorName.includes('pink')) rgbValue = '#e83e8c';\n          else if (colorName.includes('brown')) rgbValue = '#8b4513';\n          else if (variant.rgb && variant.rgb !== 'Not available') {\n            // Fall back to database RGB if available and not obviously wrong\n            try {\n              const rgbParts = variant.rgb.split('|')[0].trim();\n              const rgbNumbers = rgbParts.match(/\\d+/g);\n              \n              if (rgbNumbers && rgbNumbers.length >= 3) {\n                const r = parseInt(rgbNumbers[0]);\n                const g = parseInt(rgbNumbers[1]);\n                const b = parseInt(rgbNumbers[2]);\n                if (r >= 0 && r <= 255 && g >= 0 && g <= 255 && b >= 0 && b <= 255) {\n                  rgbValue = `rgb(${r}, ${g}, ${b})`;\n                }\n              }\n            } catch (e) {\n              console.warn('Failed to parse RGB for', variant.colour_name, ':', variant.rgb);\n            }\n          }\n          \n          colors.push({\n            code: variant.colour_code,\n            name: variant.colour_name || variant.colour_code,\n            rgb: rgbValue,\n            image: variant.colour_image || variant.primary_product_image_url\n          });\n        }\n        return colors;\n      }, []);\n\n      // Calculate price range\n      const prices = variants\n        .map(v => parseFloat(v.single_price))\n        .filter(p => !isNaN(p) && p > 0);\n      \n      const priceRange = prices.length > 0 ? {\n        min: Math.min(...prices),\n        max: Math.max(...prices)\n      } : { min: 0, max: 0 };\n      \n      return {\n        style_code: styleCode,\n        style_name: firstVariant.style_name,\n        brand: firstVariant.brand,\n        variants,\n        colors: uniqueColors,\n        size_range: firstVariant.size_range || '',\n        price_range: priceRange\n      };\n    });\n  }, []);\n\n  // Load initial products or reset with new filters\n  const loadProducts = useCallback(async (filters: ProductFilters, reset: boolean = true) => {\n    try {\n      console.log('ðŸ”„ Loading products with filters:', JSON.stringify(filters, null, 2));\n      if (reset) {\n        setLoading(true);\n        setCurrentPage(1);\n        setAllProducts([]);\n        setProductGroups([]);\n      } else {\n        setLoadingMore(true);\n      }\n      \n      const pageToLoad = reset ? 1 : currentPage;\n      const response: ProductsResponse = await getAllProducts(filters, pageToLoad, pageSize);\n      \n      console.log('ðŸ“¦ Product API Response:', {\n        totalCount: response.totalCount,\n        productsLength: response.products.length,\n        currentPage: response.currentPage,\n        totalPages: response.totalPages,\n        firstProduct: response.products[0] || 'No products'\n      });\n      \n      setTotalCount(response.totalCount);\n      setHasMoreProducts(response.hasNextPage);\n      \n      // Update products list\n      if (reset) {\n        setAllProducts(response.products);\n      } else {\n        setAllProducts(prev => [...prev, ...response.products]);\n        setCurrentPage(prev => prev + 1);\n      }\n      \n    } catch (error) {\n      console.error('âŒ Error loading products:', error);\n      if (reset) {\n        setAllProducts([]);\n        setProductGroups([]);\n        setTotalCount(0);\n        setHasMoreProducts(false);\n      }\n    } finally {\n      setLoading(false);\n      setLoadingMore(false);\n    }\n  }, [currentPage, pageSize]);\n\n  // Load more products for infinite scroll\n  const loadMoreProducts = useCallback(async () => {\n    if (!hasMoreProducts || loadingMore || loading) return;\n    await loadProducts(currentFilters, false);\n  }, [hasMoreProducts, loadingMore, loading, currentFilters, loadProducts]);\n\n  // Initial load\n  useEffect(() => {\n    loadProducts({});\n  }, []);\n\n  // Update product groups when allProducts changes\n  useEffect(() => {\n    if (allProducts.length > 0) {\n      const grouped = groupProductsByStyle(allProducts);\n      console.log('ðŸ“Š Product groups created:', grouped.length, 'groups from', allProducts.length, 'products');\n      setProductGroups(grouped);\n      \n      // Auto-load more if we don't have enough products to fill viewport\n      setTimeout(() => {\n        if (grouped.length < 12 && hasMoreProducts && !loadingMore && !loading) {\n          console.log('ðŸ”„ Auto-loading more products to fill viewport...');\n          loadMoreProducts();\n        }\n      }, 100);\n    }\n  }, [allProducts, groupProductsByStyle, hasMoreProducts, loadingMore, loading, loadMoreProducts]);\n\n  // Set up intersection observer for infinite scroll\n  useEffect(() => {\n    const observer = new IntersectionObserver(\n      (entries) => {\n        const target = entries[0];\n        if (target.isIntersecting && hasMoreProducts && !loadingMore && !loading) {\n          console.log('ðŸ”„ Loading more products...');\n          loadMoreProducts();\n        }\n      },\n      {\n        root: null,\n        rootMargin: '200px', // Start loading 200px before reaching the bottom\n        threshold: 0.1\n      }\n    );\n\n    const currentRef = loadMoreRef.current;\n    if (currentRef) {\n      observer.observe(currentRef);\n    }\n\n    return () => {\n      if (currentRef) {\n        observer.unobserve(currentRef);\n      }\n    };\n  }, [hasMoreProducts, loadingMore, loading, loadMoreProducts]);\n\n  const handleFiltersChange = (filters: ProductFilters) => {\n    setCurrentFilters(filters);\n    loadProducts(filters, true); // Reset to page 1 with new filters\n  };\n\n  const handleSmartSearch = async (query: string, filters: ProductFilters) => {\n    const searchFilters = {\n      ...filters,\n      searchQuery: query\n    };\n    console.log('Smart Search Filters Applied:', JSON.stringify(searchFilters, null, 2));\n    setCurrentFilters(searchFilters);\n    await loadProducts(searchFilters, true);\n    \n    // If no results with AI filters, try with just the search query\n    setTimeout(() => {\n      if (totalCount === 0) {\n        console.log('No results with AI filters, trying text search only...');\n        setCurrentFilters({ searchQuery: query });\n        loadProducts({ searchQuery: query }, true);\n      }\n    }, 1000);\n  };\n\n  const getActiveFilterCount = () => {\n    let count = 0;\n    Object.entries(currentFilters).forEach(([key, value]) => {\n      if (key === 'searchQuery' && value) count++;\n      else if (key.includes('price') && value !== undefined) count++;\n      else if (Array.isArray(value) && value.length > 0) count += value.length;\n    });\n    return count;\n  };\n\n  const clearAllFilters = () => {\n    setCurrentFilters({});\n    loadProducts({}, true); // true = reset to first page\n  };\n\n  return (\n    <div className=\"product-browser\">\n      <div className=\"browser-layout\">\n        {/* Header */}\n        <div className=\"browser-header\">\n          <div className=\"container\">\n            <div className=\"header-content\">\n              <div className=\"title-section\">\n                <h1>Discover Products</h1>\n                <p className=\"subtitle\">\n                  {loading ? 'Loading...' : `${productGroups.length.toLocaleString()} products${hasMoreProducts ? ' (loading more...)' : ' available'}`}\n                </p>\n              </div>\n              \n              <div className=\"header-controls\">\n                <button \n                  className=\"smart-search-btn\"\n                  onClick={() => setIsSmartSearchOpen(true)}\n                >\n                  <Sparkles size={20} />\n                  <span>Smart Search</span>\n                </button>\n                \n                <div className=\"view-toggle\">\n                  <button\n                    className={`view-btn ${viewMode === 'grid' ? 'active' : ''}`}\n                    onClick={() => setViewMode('grid')}\n                  >\n                    <Grid size={18} />\n                  </button>\n                  <button\n                    className={`view-btn ${viewMode === 'list' ? 'active' : ''}`}\n                    onClick={() => setViewMode('list')}\n                  >\n                    <List size={18} />\n                  </button>\n                </div>\n              </div>\n            </div>\n\n            {/* Active Filters Display */}\n            {currentFilters.searchQuery && (\n              <div className=\"active-search-bar\">\n                <div className=\"search-info\">\n                  <span className=\"search-label\">Search results for:</span>\n                  <span className=\"search-query\">\"{currentFilters.searchQuery}\"</span>\n                  <button \n                    className=\"clear-search-btn\" \n                    onClick={() => handleFiltersChange({ ...currentFilters, searchQuery: undefined })}\n                  >\n                    Clear search\n                  </button>\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Main Content with Sidebar */}\n        <div className=\"browser-content\">\n          <div className=\"container\">\n            <div className=\"content-layout\">\n              \n              {/* Filter Sidebar */}\n              <FilterSidebar\n                filterOptions={filterOptions}\n                currentFilters={currentFilters}\n                onFiltersChange={handleFiltersChange}\n                totalResults={totalCount}\n              />\n\n              {/* Products Area */}\n              <div className=\"products-area\">\n                {/* Loading State */}\n                {loading && (\n                  <div className=\"products-loading\">\n                    <div className={`products-skeleton ${viewMode}`}>\n                      {Array.from({ length: 12 }).map((_, i) => (\n                        <ProductSkeleton key={i} />\n                      ))}\n                    </div>\n                  </div>\n                )}\n\n                {/* Products Grid */}\n                <div className={`products-container ${viewMode}`}>\n                  {productGroups.map((group) => (\n                    <ProductCard\n                      key={group.style_code}\n                      productGroup={group}\n                      viewMode={viewMode}\n                    />\n                  ))}\n                </div>\n\n                {/* Loading More Indicator */}\n                {loadingMore && (\n                  <div className=\"loading-more\">\n                    <Loader2 className=\"loading-spinner\" size={32} />\n                    <p>Loading more products...</p>\n                  </div>\n                )}\n\n                {/* Infinite Scroll Trigger */}\n                <div ref={loadMoreRef} className=\"load-more-trigger\" style={{ height: hasMoreProducts ? '20px' : '0px' }}>\n                  {/* This invisible element triggers loading when it comes into view */}\n                </div>\n\n                {/* Empty State */}\n                {productGroups.length === 0 && !loading && (\n                  <div className=\"empty-state\">\n                    <div className=\"empty-content\">\n                      <Filter size={48} className=\"empty-icon\" />\n                      <h3>No products found</h3>\n                      <p>Try adjusting your filters or search terms</p>\n                      <button className=\"reset-filters-btn\" onClick={clearAllFilters}>\n                        Clear all filters\n                      </button>\n                    </div>\n                  </div>\n                )}\n\n                {/* End of Results */}\n                {!hasMoreProducts && productGroups.length > 0 && (\n                  <div className=\"end-of-results\">\n                    <p>You've seen all {productGroups.length} products!</p>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Smart Search Modal */}\n        <SmartSearchModal\n          isOpen={isSmartSearchOpen}\n          onClose={() => setIsSmartSearchOpen(false)}\n          onApplySearch={handleSmartSearch}\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default ProductBrowser;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}