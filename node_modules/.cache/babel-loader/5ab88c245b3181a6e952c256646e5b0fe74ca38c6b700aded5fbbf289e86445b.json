{"ast":null,"code":"import _objectSpread from\"/home/alastair/Desktop/outpost-custom/outpost-custom/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{createContext,useContext,useState,useEffect}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";const CartContext=/*#__PURE__*/createContext(undefined);export const CartProvider=_ref=>{let{children}=_ref;const[cart,setCart]=useState(()=>{const savedCart=localStorage.getItem('outpost-cart');return savedCart?JSON.parse(savedCart):[];});// Save cart to localStorage whenever it changes\nuseEffect(()=>{localStorage.setItem('outpost-cart',JSON.stringify(cart));},[cart]);const addToCart=function(product){let quantity=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;let color=arguments.length>2?arguments[2]:undefined;let size=arguments.length>3?arguments[3]:undefined;const itemId=\"\".concat(product.style_code,\"-\").concat(color||'default',\"-\").concat(size||'default');setCart(prev=>{const existingItem=prev.find(item=>item.id===itemId);if(existingItem){return prev.map(item=>item.id===itemId?_objectSpread(_objectSpread({},item),{},{quantity:item.quantity+quantity}):item);}return[...prev,{id:itemId,name:product.style_name,brand:product.brand,price:product.price_range.min,quantity,image:product.primary_product_image_url,styleCode:product.style_code,selectedColor:color,selectedSize:size}];});};const removeFromCart=id=>{setCart(prev=>prev.filter(item=>item.id!==id));};const incrementQuantity=id=>{setCart(prev=>prev.map(item=>item.id===id?_objectSpread(_objectSpread({},item),{},{quantity:item.quantity+1}):item));};const decrementQuantity=id=>{setCart(prev=>prev.map(item=>item.id===id&&item.quantity>1?_objectSpread(_objectSpread({},item),{},{quantity:item.quantity-1}):item).filter(item=>item.quantity>0));};const updateQuantity=(id,quantity)=>{if(quantity<=0){removeFromCart(id);return;}setCart(prev=>prev.map(item=>item.id===id?_objectSpread(_objectSpread({},item),{},{quantity}):item));};const clearCart=()=>{setCart([]);};const isInCart=styleCode=>{return cart.some(item=>item.styleCode===styleCode);};const getCartItemCount=()=>{return cart.reduce((total,item)=>total+item.quantity,0);};// Calculate totals\nconst subtotal=cart.reduce((sum,item)=>sum+item.price*item.quantity,0);const tax=subtotal*0.2;// 20% VAT\nconst shipping=subtotal>=50?0:4.99;// Free shipping over £50\nconst total=subtotal+tax+shipping;return/*#__PURE__*/_jsx(CartContext.Provider,{value:{cart,addToCart,removeFromCart,incrementQuantity,decrementQuantity,updateQuantity,clearCart,isInCart,getCartItemCount,subtotal,tax,shipping,total},children:children});};export const useCart=()=>{const context=useContext(CartContext);if(!context){throw new Error('useCart must be used within a CartProvider');}return context;};// Utility functions\nexport const cartUtils={formatPrice:price=>{return new Intl.NumberFormat('en-GB',{style:'currency',currency:'GBP'}).format(price);}};","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","jsx","_jsx","CartContext","undefined","CartProvider","_ref","children","cart","setCart","savedCart","localStorage","getItem","JSON","parse","setItem","stringify","addToCart","product","quantity","arguments","length","color","size","itemId","concat","style_code","prev","existingItem","find","item","id","map","_objectSpread","name","style_name","brand","price","price_range","min","image","primary_product_image_url","styleCode","selectedColor","selectedSize","removeFromCart","filter","incrementQuantity","decrementQuantity","updateQuantity","clearCart","isInCart","some","getCartItemCount","reduce","total","subtotal","sum","tax","shipping","Provider","value","useCart","context","Error","cartUtils","formatPrice","Intl","NumberFormat","style","currency","format"],"sources":["/home/alastair/Desktop/outpost-custom/outpost-custom/src/contexts/CartContext.tsx"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\nimport { GroupedProduct } from '../lib/supabase';\n\ninterface CartItem {\n  id: string;\n  name: string;\n  brand: string;\n  price: number;\n  quantity: number;\n  image: string;\n  styleCode: string;\n  selectedColor?: string;\n  selectedSize?: string;\n}\n\ninterface CartContextType {\n  cart: CartItem[];\n  addToCart: (product: GroupedProduct, quantity?: number, color?: string, size?: string) => void;\n  removeFromCart: (id: string) => void;\n  incrementQuantity: (id: string) => void;\n  decrementQuantity: (id: string) => void;\n  updateQuantity: (id: string, quantity: number) => void;\n  clearCart: () => void;\n  isInCart: (id: string) => boolean;\n  getCartItemCount: () => number;\n  subtotal: number;\n  tax: number;\n  shipping: number;\n  total: number;\n}\n\nconst CartContext = createContext<CartContextType | undefined>(undefined);\n\nexport const CartProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\n  const [cart, setCart] = useState<CartItem[]>(() => {\n    const savedCart = localStorage.getItem('outpost-cart');\n    return savedCart ? JSON.parse(savedCart) : [];\n  });\n\n  // Save cart to localStorage whenever it changes\n  useEffect(() => {\n    localStorage.setItem('outpost-cart', JSON.stringify(cart));\n  }, [cart]);\n\n  const addToCart = (product: GroupedProduct, quantity = 1, color?: string, size?: string) => {\n    const itemId = `${product.style_code}-${color || 'default'}-${size || 'default'}`;\n\n    setCart(prev => {\n      const existingItem = prev.find(item => item.id === itemId);\n\n      if (existingItem) {\n        return prev.map(item =>\n          item.id === itemId\n            ? { ...item, quantity: item.quantity + quantity }\n            : item\n        );\n      }\n\n      return [\n        ...prev,\n        {\n          id: itemId,\n          name: product.style_name,\n          brand: product.brand,\n          price: product.price_range.min,\n          quantity,\n          image: product.primary_product_image_url,\n          styleCode: product.style_code,\n          selectedColor: color,\n          selectedSize: size,\n        },\n      ];\n    });\n  };\n\n  const removeFromCart = (id: string) => {\n    setCart(prev => prev.filter(item => item.id !== id));\n  };\n\n  const incrementQuantity = (id: string) => {\n    setCart(prev =>\n      prev.map(item =>\n        item.id === id ? { ...item, quantity: item.quantity + 1 } : item\n      )\n    );\n  };\n\n  const decrementQuantity = (id: string) => {\n    setCart(prev =>\n      prev.map(item =>\n        item.id === id && item.quantity > 1\n          ? { ...item, quantity: item.quantity - 1 }\n          : item\n      ).filter(item => item.quantity > 0)\n    );\n  };\n\n  const updateQuantity = (id: string, quantity: number) => {\n    if (quantity <= 0) {\n      removeFromCart(id);\n      return;\n    }\n\n    setCart(prev =>\n      prev.map(item =>\n        item.id === id ? { ...item, quantity } : item\n      )\n    );\n  };\n\n  const clearCart = () => {\n    setCart([]);\n  };\n\n  const isInCart = (styleCode: string) => {\n    return cart.some(item => item.styleCode === styleCode);\n  };\n\n  const getCartItemCount = () => {\n    return cart.reduce((total, item) => total + item.quantity, 0);\n  };\n\n  // Calculate totals\n  const subtotal = cart.reduce((sum, item) => sum + item.price * item.quantity, 0);\n  const tax = subtotal * 0.2; // 20% VAT\n  const shipping = subtotal >= 50 ? 0 : 4.99; // Free shipping over £50\n  const total = subtotal + tax + shipping;\n\n  return (\n    <CartContext.Provider\n      value={{\n        cart,\n        addToCart,\n        removeFromCart,\n        incrementQuantity,\n        decrementQuantity,\n        updateQuantity,\n        clearCart,\n        isInCart,\n        getCartItemCount,\n        subtotal,\n        tax,\n        shipping,\n        total,\n      }}\n    >\n      {children}\n    </CartContext.Provider>\n  );\n};\n\nexport const useCart = () => {\n  const context = useContext(CartContext);\n  if (!context) {\n    throw new Error('useCart must be used within a CartProvider');\n  }\n  return context;\n};\n\n// Utility functions\nexport const cartUtils = {\n  formatPrice: (price: number) => {\n    return new Intl.NumberFormat('en-GB', {\n      style: 'currency',\n      currency: 'GBP',\n    }).format(price);\n  },\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}