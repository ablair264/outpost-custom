{"ast":null,"code":"import _objectSpread from\"/home/alastair/Desktop/outpost-custom/outpost-custom/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useCallback,useRef}from'react';import{Filter,Grid,List,Sparkles,Loader2}from'lucide-react';import{getAllProducts,getFilterOptions}from'../lib/productBrowserApi';import FilterSidebar from'../components/FilterSidebar';import SmartSearchModal from'../components/SmartSearchModal';import ProductCard from'../components/ProductCard';import ProductSkeleton from'../components/ProductSkeleton';import'./ProductBrowser.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProductBrowser=()=>{const[allProducts,setAllProducts]=useState([]);const[productGroups,setProductGroups]=useState([]);const[loading,setLoading]=useState(true);const[loadingMore,setLoadingMore]=useState(false);const[hasMoreProducts,setHasMoreProducts]=useState(true);const[currentFilters,setCurrentFilters]=useState({});const[filterOptions,setFilterOptions]=useState({materials:[],categories:[],priceRange:{min:0,max:1000},productTypes:[],sizes:[],colors:[],colorShades:[],brands:[],genders:[],ageGroups:[],accreditations:[]});const[currentPage,setCurrentPage]=useState(1);const[totalCount,setTotalCount]=useState(0);const[isSmartSearchOpen,setIsSmartSearchOpen]=useState(false);const[viewMode,setViewMode]=useState('grid');// Intersection Observer ref for infinite scroll\nconst loadMoreRef=useRef(null);const pageSize=100;// Increased to ensure viewport is filled initially\n// Load filter options on mount\nuseEffect(()=>{const loadFilterOptions=async()=>{try{const options=await getFilterOptions();setFilterOptions(options);}catch(error){console.error('Error loading filter options:',error);}};loadFilterOptions();},[]);// Group products by style (memoized to prevent unnecessary re-renders)\nconst groupProductsByStyle=useCallback(products=>{const grouped=products.reduce((groups,product)=>{const styleCode=product.style_code||'unknown';if(!groups[styleCode]){groups[styleCode]=[];}groups[styleCode].push(product);return groups;},{});// Sort the style codes to ensure consistent ordering\nconst sortedStyleCodes=Object.keys(grouped).sort();return sortedStyleCodes.map(styleCode=>{const variants=grouped[styleCode];const firstVariant=variants[0];// Get unique colors with improved color mapping\nconst uniqueColors=variants.reduce((colors,variant)=>{const existingColor=colors.find(c=>c.code===variant.colour_code);if(!existingColor&&variant.colour_code){// Use improved color mapping logic\nconst colorName=(variant.colour_name||'').toLowerCase();let rgbValue='#cccccc';// Default fallback\n// First try to use color name mapping for better accuracy\nif(colorName.includes('black'))rgbValue='#000000';else if(colorName.includes('white'))rgbValue='#ffffff';else if(colorName.includes('red'))rgbValue='#dc3545';else if(colorName.includes('blue'))rgbValue='#007bff';else if(colorName.includes('green'))rgbValue='#28a745';else if(colorName.includes('yellow'))rgbValue='#ffc107';else if(colorName.includes('grey')||colorName.includes('gray'))rgbValue='#6c757d';else if(colorName.includes('navy'))rgbValue='#001f3f';else if(colorName.includes('orange'))rgbValue='#ff6b35';else if(colorName.includes('purple'))rgbValue='#6f42c1';else if(colorName.includes('pink'))rgbValue='#e83e8c';else if(colorName.includes('brown'))rgbValue='#8b4513';else if(variant.rgb&&variant.rgb!=='Not available'){// Fall back to database RGB if available and not obviously wrong\ntry{const rgbParts=variant.rgb.split('|')[0].trim();const rgbNumbers=rgbParts.match(/\\d+/g);if(rgbNumbers&&rgbNumbers.length>=3){const r=parseInt(rgbNumbers[0]);const g=parseInt(rgbNumbers[1]);const b=parseInt(rgbNumbers[2]);if(r>=0&&r<=255&&g>=0&&g<=255&&b>=0&&b<=255){rgbValue=\"rgb(\".concat(r,\", \").concat(g,\", \").concat(b,\")\");}}}catch(e){console.warn('Failed to parse RGB for',variant.colour_name,':',variant.rgb);}}colors.push({code:variant.colour_code,name:variant.colour_name||variant.colour_code,rgb:rgbValue,image:variant.colour_image||variant.primary_product_image_url});}return colors;},[]);// Calculate price range\nconst prices=variants.map(v=>parseFloat(v.single_price)).filter(p=>!isNaN(p)&&p>0);const priceRange=prices.length>0?{min:Math.min(...prices),max:Math.max(...prices)}:{min:0,max:0};return{style_code:styleCode,style_name:firstVariant.style_name,brand:firstVariant.brand,variants,colors:uniqueColors,size_range:firstVariant.size_range||'',price_range:priceRange};});},[]);// Load initial products or reset with new filters\nconst loadProducts=useCallback(async function(filters){let reset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;try{console.log('ðŸ”„ Loading products with filters:',JSON.stringify(filters,null,2));if(reset){setLoading(true);setCurrentPage(1);setAllProducts([]);setProductGroups([]);}else{setLoadingMore(true);}const pageToLoad=reset?1:currentPage;const response=await getAllProducts(filters,pageToLoad,pageSize);console.log('ðŸ“¦ Product API Response:',{totalCount:response.totalCount,productsLength:response.products.length,currentPage:response.currentPage,totalPages:response.totalPages,firstProduct:response.products[0]||'No products'});setTotalCount(response.totalCount);setHasMoreProducts(response.hasNextPage);// Update products list\nif(reset){setAllProducts(response.products);}else{setAllProducts(prev=>[...prev,...response.products]);setCurrentPage(prev=>prev+1);}}catch(error){console.error('âŒ Error loading products:',error);if(reset){setAllProducts([]);setProductGroups([]);setTotalCount(0);setHasMoreProducts(false);}}finally{setLoading(false);setLoadingMore(false);}},[currentPage,pageSize]);// Load more products for infinite scroll\nconst loadMoreProducts=useCallback(async()=>{if(!hasMoreProducts||loadingMore||loading)return;await loadProducts(currentFilters,false);},[hasMoreProducts,loadingMore,loading,currentFilters,loadProducts]);// Initial load\nuseEffect(()=>{loadProducts({});},[]);// Update product groups when allProducts changes\nuseEffect(()=>{if(allProducts.length>0){const grouped=groupProductsByStyle(allProducts);console.log('ðŸ“Š Product groups created:',grouped.length,'groups from',allProducts.length,'products');setProductGroups(grouped);// Auto-load more if we don't have enough products to fill viewport\nsetTimeout(()=>{if(grouped.length<12&&hasMoreProducts&&!loadingMore&&!loading){console.log('ðŸ”„ Auto-loading more products to fill viewport...');loadMoreProducts();}},100);}},[allProducts,groupProductsByStyle,hasMoreProducts,loadingMore,loading,loadMoreProducts]);// Set up intersection observer for infinite scroll\nuseEffect(()=>{const observer=new IntersectionObserver(entries=>{const target=entries[0];if(target.isIntersecting&&hasMoreProducts&&!loadingMore&&!loading){console.log('ðŸ”„ Loading more products...');loadMoreProducts();}},{root:null,rootMargin:'200px',// Start loading 200px before reaching the bottom\nthreshold:0.1});const currentRef=loadMoreRef.current;if(currentRef){observer.observe(currentRef);}return()=>{if(currentRef){observer.unobserve(currentRef);}};},[hasMoreProducts,loadingMore,loading,loadMoreProducts]);const handleFiltersChange=filters=>{setCurrentFilters(filters);loadProducts(filters,true);// Reset to page 1 with new filters\n};const handleSmartSearch=async(query,filters)=>{const searchFilters=_objectSpread(_objectSpread({},filters),{},{searchQuery:query});console.log('Smart Search Filters Applied:',JSON.stringify(searchFilters,null,2));setCurrentFilters(searchFilters);await loadProducts(searchFilters,true);// If no results with AI filters, try with just the search query\nsetTimeout(()=>{if(totalCount===0){console.log('No results with AI filters, trying text search only...');setCurrentFilters({searchQuery:query});loadProducts({searchQuery:query},true);}},1000);};const getActiveFilterCount=()=>{let count=0;Object.entries(currentFilters).forEach(_ref=>{let[key,value]=_ref;if(key==='searchQuery'&&value)count++;else if(key.includes('price')&&value!==undefined)count++;else if(Array.isArray(value)&&value.length>0)count+=value.length;});return count;};const clearAllFilters=()=>{setCurrentFilters({});loadProducts({},true);// true = reset to first page\n};return/*#__PURE__*/_jsx(\"div\",{className:\"product-browser\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"browser-layout\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"browser-header\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"header-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"title-section\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Discover Products\"}),/*#__PURE__*/_jsx(\"p\",{className:\"subtitle\",children:loading?'Loading...':\"\".concat(productGroups.length.toLocaleString(),\" products\").concat(hasMoreProducts?' (loading more...)':' available')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"header-controls\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"smart-search-btn\",onClick:()=>setIsSmartSearchOpen(true),children:[/*#__PURE__*/_jsx(Sparkles,{size:20}),/*#__PURE__*/_jsx(\"span\",{children:\"Smart Search\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"view-toggle\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"view-btn \".concat(viewMode==='grid'?'active':''),onClick:()=>setViewMode('grid'),children:/*#__PURE__*/_jsx(Grid,{size:18})}),/*#__PURE__*/_jsx(\"button\",{className:\"view-btn \".concat(viewMode==='list'?'active':''),onClick:()=>setViewMode('list'),children:/*#__PURE__*/_jsx(List,{size:18})})]})]})]}),currentFilters.searchQuery&&/*#__PURE__*/_jsx(\"div\",{className:\"active-search-bar\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"search-info\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"search-label\",children:\"Search results for:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"search-query\",children:[\"\\\"\",currentFilters.searchQuery,\"\\\"\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"clear-search-btn\",onClick:()=>handleFiltersChange(_objectSpread(_objectSpread({},currentFilters),{},{searchQuery:undefined})),children:\"Clear search\"})]})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"browser-content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"content-layout\",children:[/*#__PURE__*/_jsx(FilterSidebar,{filterOptions:filterOptions,currentFilters:currentFilters,onFiltersChange:handleFiltersChange,totalResults:totalCount}),/*#__PURE__*/_jsxs(\"div\",{className:\"products-area\",children:[loading&&/*#__PURE__*/_jsx(\"div\",{className:\"products-loading\",children:/*#__PURE__*/_jsx(\"div\",{className:\"products-skeleton \".concat(viewMode),children:Array.from({length:12}).map((_,i)=>/*#__PURE__*/_jsx(ProductSkeleton,{},i))})}),/*#__PURE__*/_jsx(\"div\",{className:\"products-container \".concat(viewMode),children:productGroups.map(group=>/*#__PURE__*/_jsx(ProductCard,{productGroup:group,viewMode:viewMode},group.style_code))}),loadingMore&&/*#__PURE__*/_jsxs(\"div\",{className:\"loading-more\",children:[/*#__PURE__*/_jsx(Loader2,{className:\"loading-spinner\",size:32}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading more products...\"})]}),/*#__PURE__*/_jsx(\"div\",{ref:loadMoreRef,className:\"load-more-trigger\",style:{height:hasMoreProducts?'20px':'0px'}}),productGroups.length===0&&!loading&&/*#__PURE__*/_jsx(\"div\",{className:\"empty-state\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"empty-content\",children:[/*#__PURE__*/_jsx(Filter,{size:48,className:\"empty-icon\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"No products found\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Try adjusting your filters or search terms\"}),/*#__PURE__*/_jsx(\"button\",{className:\"reset-filters-btn\",onClick:clearAllFilters,children:\"Clear all filters\"})]})}),!hasMoreProducts&&productGroups.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"end-of-results\",children:/*#__PURE__*/_jsxs(\"p\",{children:[\"You've seen all \",productGroups.length,\" products!\"]})})]})]})})}),/*#__PURE__*/_jsx(SmartSearchModal,{isOpen:isSmartSearchOpen,onClose:()=>setIsSmartSearchOpen(false),onApplySearch:handleSmartSearch})]})});};export default ProductBrowser;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useRef","Filter","Grid","List","Sparkles","Loader2","getAllProducts","getFilterOptions","FilterSidebar","SmartSearchModal","ProductCard","ProductSkeleton","jsx","_jsx","jsxs","_jsxs","ProductBrowser","allProducts","setAllProducts","productGroups","setProductGroups","loading","setLoading","loadingMore","setLoadingMore","hasMoreProducts","setHasMoreProducts","currentFilters","setCurrentFilters","filterOptions","setFilterOptions","materials","categories","priceRange","min","max","productTypes","sizes","colors","colorShades","brands","genders","ageGroups","accreditations","currentPage","setCurrentPage","totalCount","setTotalCount","isSmartSearchOpen","setIsSmartSearchOpen","viewMode","setViewMode","loadMoreRef","pageSize","loadFilterOptions","options","error","console","groupProductsByStyle","products","grouped","reduce","groups","product","styleCode","style_code","push","sortedStyleCodes","Object","keys","sort","map","variants","firstVariant","uniqueColors","variant","existingColor","find","c","code","colour_code","colorName","colour_name","toLowerCase","rgbValue","includes","rgb","rgbParts","split","trim","rgbNumbers","match","length","r","parseInt","g","b","concat","e","warn","name","image","colour_image","primary_product_image_url","prices","v","parseFloat","single_price","filter","p","isNaN","Math","style_name","brand","size_range","price_range","loadProducts","filters","reset","arguments","undefined","log","JSON","stringify","pageToLoad","response","productsLength","totalPages","firstProduct","hasNextPage","prev","loadMoreProducts","setTimeout","observer","IntersectionObserver","entries","target","isIntersecting","root","rootMargin","threshold","currentRef","current","observe","unobserve","handleFiltersChange","handleSmartSearch","query","searchFilters","_objectSpread","searchQuery","getActiveFilterCount","count","forEach","_ref","key","value","Array","isArray","clearAllFilters","className","children","toLocaleString","onClick","size","onFiltersChange","totalResults","from","_","i","group","productGroup","ref","style","height","isOpen","onClose","onApplySearch"],"sources":["/home/alastair/Desktop/outpost-custom/outpost-custom/src/pages/ProductBrowser.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { Filter, Grid, List, Sparkles, Loader2 } from 'lucide-react';\nimport { getAllProducts, getFilterOptions, ProductFilters, ProductsResponse, FilterOptions } from '../lib/productBrowserApi';\nimport { Product } from '../lib/supabase';\nimport FilterSidebar from '../components/FilterSidebar';\nimport SmartSearchModal from '../components/SmartSearchModal';\nimport ProductCard from '../components/ProductCard';\nimport ProductSkeleton from '../components/ProductSkeleton';\nimport './ProductBrowser.css';\n\ninterface ProductGroup {\n  style_code: string;\n  style_name: string;\n  brand: string;\n  variants: Product[];\n  colors: Array<{\n    code: string;\n    name: string;\n    rgb: string;\n    image: string;\n  }>;\n  size_range: string;\n  price_range: { min: number; max: number };\n}\n\nconst ProductBrowser: React.FC = () => {\n  const [allProducts, setAllProducts] = useState<Product[]>([]);\n  const [productGroups, setProductGroups] = useState<ProductGroup[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [loadingMore, setLoadingMore] = useState(false);\n  const [hasMoreProducts, setHasMoreProducts] = useState(true);\n  const [currentFilters, setCurrentFilters] = useState<ProductFilters>({});\n  const [filterOptions, setFilterOptions] = useState<FilterOptions>({\n    materials: [],\n    categories: [],\n    priceRange: { min: 0, max: 1000 },\n    productTypes: [],\n    sizes: [],\n    colors: [],\n    colorShades: [],\n    brands: [],\n    genders: [],\n    ageGroups: [],\n    accreditations: []\n  });\n  \n  const [currentPage, setCurrentPage] = useState(1);\n  const [totalCount, setTotalCount] = useState(0);\n  \n  const [isSmartSearchOpen, setIsSmartSearchOpen] = useState(false);\n  const [viewMode, setViewMode] = useState<'grid' | 'list'>('grid');\n  \n  // Intersection Observer ref for infinite scroll\n  const loadMoreRef = useRef<HTMLDivElement>(null);\n  \n  const pageSize = 100; // Increased to ensure viewport is filled initially\n\n  // Load filter options on mount\n  useEffect(() => {\n    const loadFilterOptions = async () => {\n      try {\n        const options = await getFilterOptions();\n        setFilterOptions(options);\n      } catch (error) {\n        console.error('Error loading filter options:', error);\n      }\n    };\n    loadFilterOptions();\n  }, []);\n\n  // Group products by style (memoized to prevent unnecessary re-renders)\n  const groupProductsByStyle = useCallback((products: Product[]): ProductGroup[] => {\n    const grouped = products.reduce((groups: Record<string, Product[]>, product) => {\n      const styleCode = product.style_code || 'unknown';\n      if (!groups[styleCode]) {\n        groups[styleCode] = [];\n      }\n      groups[styleCode].push(product);\n      return groups;\n    }, {});\n\n    // Sort the style codes to ensure consistent ordering\n    const sortedStyleCodes = Object.keys(grouped).sort();\n    \n    return sortedStyleCodes.map(styleCode => {\n      const variants = grouped[styleCode];\n      const firstVariant = variants[0];\n      \n      // Get unique colors with improved color mapping\n      const uniqueColors = variants.reduce((colors: Array<{code: string, name: string, rgb: string, image: string}>, variant) => {\n        const existingColor = colors.find(c => c.code === variant.colour_code);\n        if (!existingColor && variant.colour_code) {\n          // Use improved color mapping logic\n          const colorName = (variant.colour_name || '').toLowerCase();\n          let rgbValue = '#cccccc'; // Default fallback\n          \n          // First try to use color name mapping for better accuracy\n          if (colorName.includes('black')) rgbValue = '#000000';\n          else if (colorName.includes('white')) rgbValue = '#ffffff';\n          else if (colorName.includes('red')) rgbValue = '#dc3545';\n          else if (colorName.includes('blue')) rgbValue = '#007bff';\n          else if (colorName.includes('green')) rgbValue = '#28a745';\n          else if (colorName.includes('yellow')) rgbValue = '#ffc107';\n          else if (colorName.includes('grey') || colorName.includes('gray')) rgbValue = '#6c757d';\n          else if (colorName.includes('navy')) rgbValue = '#001f3f';\n          else if (colorName.includes('orange')) rgbValue = '#ff6b35';\n          else if (colorName.includes('purple')) rgbValue = '#6f42c1';\n          else if (colorName.includes('pink')) rgbValue = '#e83e8c';\n          else if (colorName.includes('brown')) rgbValue = '#8b4513';\n          else if (variant.rgb && variant.rgb !== 'Not available') {\n            // Fall back to database RGB if available and not obviously wrong\n            try {\n              const rgbParts = variant.rgb.split('|')[0].trim();\n              const rgbNumbers = rgbParts.match(/\\d+/g);\n              \n              if (rgbNumbers && rgbNumbers.length >= 3) {\n                const r = parseInt(rgbNumbers[0]);\n                const g = parseInt(rgbNumbers[1]);\n                const b = parseInt(rgbNumbers[2]);\n                if (r >= 0 && r <= 255 && g >= 0 && g <= 255 && b >= 0 && b <= 255) {\n                  rgbValue = `rgb(${r}, ${g}, ${b})`;\n                }\n              }\n            } catch (e) {\n              console.warn('Failed to parse RGB for', variant.colour_name, ':', variant.rgb);\n            }\n          }\n          \n          colors.push({\n            code: variant.colour_code,\n            name: variant.colour_name || variant.colour_code,\n            rgb: rgbValue,\n            image: variant.colour_image || variant.primary_product_image_url\n          });\n        }\n        return colors;\n      }, []);\n\n      // Calculate price range\n      const prices = variants\n        .map(v => parseFloat(v.single_price))\n        .filter(p => !isNaN(p) && p > 0);\n      \n      const priceRange = prices.length > 0 ? {\n        min: Math.min(...prices),\n        max: Math.max(...prices)\n      } : { min: 0, max: 0 };\n      \n      return {\n        style_code: styleCode,\n        style_name: firstVariant.style_name,\n        brand: firstVariant.brand,\n        variants,\n        colors: uniqueColors,\n        size_range: firstVariant.size_range || '',\n        price_range: priceRange\n      };\n    });\n  }, []);\n\n  // Load initial products or reset with new filters\n  const loadProducts = useCallback(async (filters: ProductFilters, reset: boolean = true) => {\n    try {\n      console.log('ðŸ”„ Loading products with filters:', JSON.stringify(filters, null, 2));\n      if (reset) {\n        setLoading(true);\n        setCurrentPage(1);\n        setAllProducts([]);\n        setProductGroups([]);\n      } else {\n        setLoadingMore(true);\n      }\n      \n      const pageToLoad = reset ? 1 : currentPage;\n      const response: ProductsResponse = await getAllProducts(filters, pageToLoad, pageSize);\n      \n      console.log('ðŸ“¦ Product API Response:', {\n        totalCount: response.totalCount,\n        productsLength: response.products.length,\n        currentPage: response.currentPage,\n        totalPages: response.totalPages,\n        firstProduct: response.products[0] || 'No products'\n      });\n      \n      setTotalCount(response.totalCount);\n      setHasMoreProducts(response.hasNextPage);\n      \n      // Update products list\n      if (reset) {\n        setAllProducts(response.products);\n      } else {\n        setAllProducts(prev => [...prev, ...response.products]);\n        setCurrentPage(prev => prev + 1);\n      }\n      \n    } catch (error) {\n      console.error('âŒ Error loading products:', error);\n      if (reset) {\n        setAllProducts([]);\n        setProductGroups([]);\n        setTotalCount(0);\n        setHasMoreProducts(false);\n      }\n    } finally {\n      setLoading(false);\n      setLoadingMore(false);\n    }\n  }, [currentPage, pageSize]);\n\n  // Load more products for infinite scroll\n  const loadMoreProducts = useCallback(async () => {\n    if (!hasMoreProducts || loadingMore || loading) return;\n    await loadProducts(currentFilters, false);\n  }, [hasMoreProducts, loadingMore, loading, currentFilters, loadProducts]);\n\n  // Initial load\n  useEffect(() => {\n    loadProducts({});\n  }, []);\n\n  // Update product groups when allProducts changes\n  useEffect(() => {\n    if (allProducts.length > 0) {\n      const grouped = groupProductsByStyle(allProducts);\n      console.log('ðŸ“Š Product groups created:', grouped.length, 'groups from', allProducts.length, 'products');\n      setProductGroups(grouped);\n      \n      // Auto-load more if we don't have enough products to fill viewport\n      setTimeout(() => {\n        if (grouped.length < 12 && hasMoreProducts && !loadingMore && !loading) {\n          console.log('ðŸ”„ Auto-loading more products to fill viewport...');\n          loadMoreProducts();\n        }\n      }, 100);\n    }\n  }, [allProducts, groupProductsByStyle, hasMoreProducts, loadingMore, loading, loadMoreProducts]);\n\n  // Set up intersection observer for infinite scroll\n  useEffect(() => {\n    const observer = new IntersectionObserver(\n      (entries) => {\n        const target = entries[0];\n        if (target.isIntersecting && hasMoreProducts && !loadingMore && !loading) {\n          console.log('ðŸ”„ Loading more products...');\n          loadMoreProducts();\n        }\n      },\n      {\n        root: null,\n        rootMargin: '200px', // Start loading 200px before reaching the bottom\n        threshold: 0.1\n      }\n    );\n\n    const currentRef = loadMoreRef.current;\n    if (currentRef) {\n      observer.observe(currentRef);\n    }\n\n    return () => {\n      if (currentRef) {\n        observer.unobserve(currentRef);\n      }\n    };\n  }, [hasMoreProducts, loadingMore, loading, loadMoreProducts]);\n\n  const handleFiltersChange = (filters: ProductFilters) => {\n    setCurrentFilters(filters);\n    loadProducts(filters, true); // Reset to page 1 with new filters\n  };\n\n  const handleSmartSearch = async (query: string, filters: ProductFilters) => {\n    const searchFilters = {\n      ...filters,\n      searchQuery: query\n    };\n    console.log('Smart Search Filters Applied:', JSON.stringify(searchFilters, null, 2));\n    setCurrentFilters(searchFilters);\n    await loadProducts(searchFilters, true);\n    \n    // If no results with AI filters, try with just the search query\n    setTimeout(() => {\n      if (totalCount === 0) {\n        console.log('No results with AI filters, trying text search only...');\n        setCurrentFilters({ searchQuery: query });\n        loadProducts({ searchQuery: query }, true);\n      }\n    }, 1000);\n  };\n\n  const getActiveFilterCount = () => {\n    let count = 0;\n    Object.entries(currentFilters).forEach(([key, value]) => {\n      if (key === 'searchQuery' && value) count++;\n      else if (key.includes('price') && value !== undefined) count++;\n      else if (Array.isArray(value) && value.length > 0) count += value.length;\n    });\n    return count;\n  };\n\n  const clearAllFilters = () => {\n    setCurrentFilters({});\n    loadProducts({}, true); // true = reset to first page\n  };\n\n  return (\n    <div className=\"product-browser\">\n      <div className=\"browser-layout\">\n        {/* Header */}\n        <div className=\"browser-header\">\n          <div className=\"container\">\n            <div className=\"header-content\">\n              <div className=\"title-section\">\n                <h1>Discover Products</h1>\n                <p className=\"subtitle\">\n                  {loading ? 'Loading...' : `${productGroups.length.toLocaleString()} products${hasMoreProducts ? ' (loading more...)' : ' available'}`}\n                </p>\n              </div>\n              \n              <div className=\"header-controls\">\n                <button \n                  className=\"smart-search-btn\"\n                  onClick={() => setIsSmartSearchOpen(true)}\n                >\n                  <Sparkles size={20} />\n                  <span>Smart Search</span>\n                </button>\n                \n                <div className=\"view-toggle\">\n                  <button\n                    className={`view-btn ${viewMode === 'grid' ? 'active' : ''}`}\n                    onClick={() => setViewMode('grid')}\n                  >\n                    <Grid size={18} />\n                  </button>\n                  <button\n                    className={`view-btn ${viewMode === 'list' ? 'active' : ''}`}\n                    onClick={() => setViewMode('list')}\n                  >\n                    <List size={18} />\n                  </button>\n                </div>\n              </div>\n            </div>\n\n            {/* Active Filters Display */}\n            {currentFilters.searchQuery && (\n              <div className=\"active-search-bar\">\n                <div className=\"search-info\">\n                  <span className=\"search-label\">Search results for:</span>\n                  <span className=\"search-query\">\"{currentFilters.searchQuery}\"</span>\n                  <button \n                    className=\"clear-search-btn\" \n                    onClick={() => handleFiltersChange({ ...currentFilters, searchQuery: undefined })}\n                  >\n                    Clear search\n                  </button>\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Main Content with Sidebar */}\n        <div className=\"browser-content\">\n          <div className=\"container\">\n            <div className=\"content-layout\">\n              \n              {/* Filter Sidebar */}\n              <FilterSidebar\n                filterOptions={filterOptions}\n                currentFilters={currentFilters}\n                onFiltersChange={handleFiltersChange}\n                totalResults={totalCount}\n              />\n\n              {/* Products Area */}\n              <div className=\"products-area\">\n                {/* Loading State */}\n                {loading && (\n                  <div className=\"products-loading\">\n                    <div className={`products-skeleton ${viewMode}`}>\n                      {Array.from({ length: 12 }).map((_, i) => (\n                        <ProductSkeleton key={i} />\n                      ))}\n                    </div>\n                  </div>\n                )}\n\n                {/* Products Grid */}\n                <div className={`products-container ${viewMode}`}>\n                  {productGroups.map((group) => (\n                    <ProductCard\n                      key={group.style_code}\n                      productGroup={group}\n                      viewMode={viewMode}\n                    />\n                  ))}\n                </div>\n\n                {/* Loading More Indicator */}\n                {loadingMore && (\n                  <div className=\"loading-more\">\n                    <Loader2 className=\"loading-spinner\" size={32} />\n                    <p>Loading more products...</p>\n                  </div>\n                )}\n\n                {/* Infinite Scroll Trigger */}\n                <div ref={loadMoreRef} className=\"load-more-trigger\" style={{ height: hasMoreProducts ? '20px' : '0px' }}>\n                  {/* This invisible element triggers loading when it comes into view */}\n                </div>\n\n                {/* Empty State */}\n                {productGroups.length === 0 && !loading && (\n                  <div className=\"empty-state\">\n                    <div className=\"empty-content\">\n                      <Filter size={48} className=\"empty-icon\" />\n                      <h3>No products found</h3>\n                      <p>Try adjusting your filters or search terms</p>\n                      <button className=\"reset-filters-btn\" onClick={clearAllFilters}>\n                        Clear all filters\n                      </button>\n                    </div>\n                  </div>\n                )}\n\n                {/* End of Results */}\n                {!hasMoreProducts && productGroups.length > 0 && (\n                  <div className=\"end-of-results\">\n                    <p>You've seen all {productGroups.length} products!</p>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Smart Search Modal */}\n        <SmartSearchModal\n          isOpen={isSmartSearchOpen}\n          onClose={() => setIsSmartSearchOpen(false)}\n          onApplySearch={handleSmartSearch}\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default ProductBrowser;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}